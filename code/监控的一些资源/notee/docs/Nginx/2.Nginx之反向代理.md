## 介绍

Nginx 的主要三个应用场景:

- 动静分离
- 反向代理
- 负载均衡

## 正向代理和反向代理

反向代理（Reverse Proxy）对应的是正向代理（Forward Proxy），他们的区别：

#### **正向代理：**

是一个位于客户端和原始服务器(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。正向代理一般是在客户端设置代理服务器，通过代理服务器转发请求，最终访问到目标服务器。
**正向代理隐藏了真实的客户端，为客户端收发请求，使真实客户端对服务器不可见。**

例子: 你的浏览器无法直接访问谷歌，这时候可以通过一个代理服务器来帮助你访问谷歌，那么这个服务器就叫正向代理。

<img src="https://zwhid.oss-cn-shenzhen.aliyuncs.com/blog/05-15-OTJ2Pr.png" alt="image-20220515195824009" style="zoom:67%;" />

#### **反向代理：**

反向代理服务器位于用户与目标服务器之间，但是对于用户而言，反向代理服务器就相当于目标服务器，即用户直接访问反向代理服务器就可以获得目标服务器的资源，反向代理服务器负责将请求转发给目标服务器。用户不需要知道目标服务器的地址，也无须在用户端作任何设定。一般在处理跨域请求的时候比较常用。现在基本上所有的大型网站都设置了反向代理。
**反向代理隐藏了真实的服务器，为服务器收发请求，使真实服务器对客户端不可见。**

例子: 去饭店吃饭，可以点川菜、粤菜、江浙菜，饭店也分别有三个菜系的厨师，但是你作为顾客不用管哪个厨师给你做的菜，只用点菜即可，小二将你菜单中的菜分配给不同的厨师来具体处理，那么这个小二就是反向代理服务器。打的

<img src="https://zwhid.oss-cn-shenzhen.aliyuncs.com/blog/05-15-fdUVjF.png" alt="image-20220515200123600" style="zoom: 67%;" />

> 简单的说，一般给客户端做代理的都是正向代理，给服务器做代理的就是反向代理。

## 配置反向代理

```bash
# localhost IP = 192.168.138.101
server {
    listen 82;
    server_name 192.168.138.100;
    location / {
        proxy_pass http://192.168.138.101:8080; # 反向代理配置，将请求转发到指定服务
    }
}
```

![image-20220515200309238](https://zwhid.oss-cn-shenzhen.aliyuncs.com/blog/05-15-ksrIdL.png)

实现效果，所有访问`192.168.138.100:82`的请求，实际响应都是`192.168.138.101:8080`

`192.168.138.100:82` =>`192.168.138.101:8080`

```bash
server {
        listen       80;
        server_name  localhost;

        location / {
            root   html/dist;
            index  index.html;
        }

        location ^~ /api/ {
          rewrite ^/api/(.*)$ /$1 break;
          proxy_pass http://192.168.138.101:8080;
        }

        location = /50x.html {
            root   html;
        }
    }
```
