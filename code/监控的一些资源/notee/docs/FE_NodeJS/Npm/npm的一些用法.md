# npm 的一些用法

## npm 版本规范

npm 采用了 semver 规范作为依赖版本管理方案。semver 约定一个包的版本号必须包含 3 个数字

```
MAJOR.MINOR.PATCH` 意思是 `主版本号.小版本号.修订版本号
```

- MAJOR 对应大的版本号迭代，做了不兼容旧版的修改时要更新 MAJOR 版本号
- MINOR 对应小版本迭代，发生兼容旧版 API 的修改或功能更新时，更新 MINOR 版本号
- PATCH 对应修订版本号，一般针对修复 BUG 的版本号

当我们每次发布包的时候都需要升级版本号

```bash
npm version major  # 大版本号加 1，其余版本号归 0
npm version minor  # 小版本号加 1，修订号归 0
npm version patch  # 修订号加 1
```

如果使用 git 管理项目会自动 `git tag` 标注版本号

来看看版本号的标识含义:

| range           | 含义                                      | 例                                              |
| --------------- | ----------------------------------------- | ----------------------------------------------- |
| `^2.2.1`        | 指定的 MAJOR 版本号下, 所有更新的版本     |  匹配 `2.2.3`, `2.3.0`; 不匹配 `1.0.3`, `3.0.1` |
| `~2.2.1`        | 指定 MAJOR.MINOR 版本号下，所有更新的版本 | 匹配 `2.2.3`, `2.2.9` ; 不匹配 `2.3.0`, `2.4.5` |
| `>=2.1`         | 版本号大于或等于 `2.1.0`                  | 匹配 `2.1.2`, `3.1`                             |
| `<=2.2`         | 版本号小于或等于 `2.2`                    | 匹配 `1.0.0`, `2.2.1`, `2.2.11`                 |
| `1.0.0 - 2.0.0` | 版本号  从 1.0.0 (含) 到 2.0.0 (含)       | 匹配 `1.0.0`, `1.3.4`, `2.0.0`                  |

## npm 的其他指令

- npm link 可以把当前模块临时放到 npm 下，方便调试使用
- npm run dev 能全局运行 webpack 的原因是，npm run 时会默认将当前 node_modules 下的.bin 目录放到全局，而 .bin 目录下有 webpack 命令

```bash
"scripts": {
	"dev": "webpack a.ja"
}
```

- npx webpack 用 npx 运行，会自动检测是否存在 webpack，如果不存在会自动下载，运行完也会自动卸载

> 比如使用`npx -p node@6 npm run test`：
>
> - npx 会帮助你下载 node@6
> - 将此时的环境变成 node@6 版本
> - 使用 node@6 帮你执行 npm run test
> - 命令执行完毕之后不会修改你原来的 node 版本
>
> 指令可以理解为使用 node@6 版本运行`npm run test`

### npm 发布包

> npm addUser 登录账号，如果账号不存在就是注册账号
>
> npm login 登录账号
>
> npm publish 发布包
